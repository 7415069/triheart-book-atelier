<!-- src/views/portal/Home.vue -->
<template>
  <div class="portal-home">
    <div class="page-container main-content">

      <!-- =========================================
           1. å¹³å°æ„¿æ™¯ (Hero Section)
           ========================================= -->
      <section class="common-section">
        <div class="section-header">
          <h2 class="section-title">å¹³å°æ„¿æ™¯</h2>
        </div>

        <div class="section-card hero-card-layout">
          <!-- Left: Text -->
          <div class="hero-text-side">
            <h1 class="hero-slogan">
              åšå®ç°çŸ¥è¯†è‡ªç”±çš„é“²å­
            </h1>

            <div class="hero-rotate-container">
              <transition name="fade-slide" mode="out-in">
                <span :key="rotateIndex" class="rotate-item">
                  {{ currentRotateText }}
                </span>
              </transition>
            </div>

            <p class="hero-desc">ç”¨æŠ€æœ¯é‡å¡‘é˜…è¯»ä½“éªŒï¼Œè¿æ¥æœ€ç¡¬æ ¸çš„å¤§è„‘ä¸æœ€æ¸´æ±‚çš„çµé­‚ã€‚æ‹’ç»æ­»è®°ç¡¬èƒŒï¼Œä»â€œçœ‹ä¸æ‡‚â€åˆ°â€œä¼šå¿ƒä¸€ç¬‘â€ï¼› æ‹’ç»â€œç”¨çˆ±å‘ç”µâ€ï¼Œè®©åˆ›ä½œä»·å€¼å›å½’ã€‚</p>

            <div class="hero-actions">
              <!-- åªä¿ç•™è¿›å…¥ä¹¦åŠ -->
              <button class="btn-primary" @click="router.push('/bookshelf')">
                è¿›å…¥ä¹¦åŠ
              </button>
            </div>
          </div>

          <!-- Right: Visual (3D Book) -->
          <div class="hero-visual-side">
            <div class="mock-book-group">
              <div class="visual-book">
                <div class="vb-face-content">
                  <div class="vb-cover-title">
                    <span class="vb-main-text">çŸ¥è¯†è‡ªç”±</span>
                  </div>
                  <div class="vb-features">
                    <div class="vb-feat-item"><span class="feat-icon">ğŸš€</span> ä»£ç ä¸‹è½½</div>
                    <div class="vb-feat-item"><span class="feat-icon">ğŸ¬</span> è§†é¢‘ä¼´è¯»</div>
                    <div class="vb-feat-item"><span class="feat-icon">ğŸ”</span> æœ¯è¯­é«˜äº®</div>
                    <div class="vb-feat-item"><span class="feat-icon">ğŸ“</span> è¯»ä¹¦ç¬”è®°</div>
                  </div>
                </div>
                <div class="vb-spine"></div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- =========================================
           2. è‡´ åˆ›ä½œè€… (Author Features)
           ========================================= -->
      <section class="common-section">
        <div class="section-header">
          <h2 class="section-title">è‡´ åˆ›ä½œè€…</h2>
          <span class="section-subtitle">åˆ›ä½œï¼Œæ˜¯ä½“é¢çš„åŠ³åŠ¨</span>
        </div>

        <div class="role-grid">
          <template v-if="config.authorFeatures?.list">
            <div v-for="(item, idx) in config.authorFeatures.list" :key="'a-' + idx" class="wr-feature-card">
              <div class="fc-icon">{{ item.icon }}</div>
              <h3 class="fc-title">{{ item.title }}</h3>
              <p class="fc-desc">{{ item.desc }}</p>
            </div>
          </template>
        </div>
      </section>

      <!-- =========================================
           3. è‡´ æ±‚ç´¢è€… (Reader Features)
           ========================================= -->
      <section class="common-section">
        <div class="section-header">
          <h2 class="section-title">è‡´ æ±‚ç´¢è€…</h2>
          <span class="section-subtitle">é˜…è¯»ï¼Œæ˜¯äº«å—çš„æ—…ç¨‹</span>
        </div>

        <div class="role-grid">
          <template v-if="config.readerFeatures?.list">
            <div v-for="(item, idx) in config.readerFeatures.list" :key="'r-' + idx" class="wr-feature-card">
              <div class="fc-icon">{{ item.icon }}</div>
              <h3 class="fc-title">{{ item.title }}</h3>
              <p class="fc-desc">{{ item.desc }}</p>
            </div>
          </template>
        </div>
      </section>

      <!-- =========================================
           4. å¹³å°ä¿¡ä»° (Credo)
           ========================================= -->
      <section class="common-section">
        <div class="section-header">
          <h2 class="section-title">å¹³å°ä¿¡ä»°</h2>
        </div>

        <div class="section-card credo-layout">
          <div class="credo-diagram">
            <span class="cd-item">ä½œè€…å¿ƒ</span>
            <span class="cd-line"></span>
            <span class="cd-item active">å¹³å°å¿ƒ</span>
            <span class="cd-line"></span>
            <span class="cd-item">è¯»è€…å¿ƒ</span>
          </div>

          <div class="credo-value">å¿ƒå¿ƒå¿ƒç›¸å° Â· äº’ä¸ºå…±ç”Ÿ</div>
          <h2 class="credo-text">åˆå¿ƒ Â· åŒ å¿ƒ Â· è¯šå¿ƒ</h2>
          <p class="credo-sub">ä¸åšæµé‡çš„å¥´éš¶ï¼Œåªåšæœ‰ç”¨çš„é“²å­</p>
        </div>
      </section>

    </div> <!-- End page-container -->

    <footer class="portal-footer">
      <div class="page-container">
        &copy; 2026 ä¸‰å¿ƒä¹¦åŠ. All Rights Reserved.
      </div>
    </footer>
  </div>
</template>

<script setup lang="ts">
import {computed, onMounted, onUnmounted, ref} from 'vue'
import {useRouter} from 'vue-router'
import {getHomeConfig} from '@/api/portal'

const router = useRouter()

// ä»…ä¿ç•™é…ç½®æ•°æ®ï¼Œä¸å†éœ€è¦ books åˆ—è¡¨
const config = ref<any>({
  authorFeatures: {list: []},
  readerFeatures: {list: []}
})

// è½®æ’­æ–‡å­—
const rotateIndex = ref(0)
const rotateInterval = ref<any>(null)

const currentRotateText = computed(() => {
  const list = [
    'è®©åˆ›ä½œ Â· å®‰å¿ƒ Â· çœå¿ƒ Â· æœ‰åˆ©å¿ƒ',
    'ä½¿é˜…è¯» Â· èˆ’å¿ƒ Â· ä¼šå¿ƒ Â· èƒ½å®šå¿ƒ'
  ]
  return list[rotateIndex.value % list.length]
})

const resetInterval = () => {
  if (rotateInterval.value) {
    clearInterval(rotateInterval.value)
  }
  rotateInterval.value = setInterval(() => {
    rotateIndex.value++
  }, 5000)
}

onMounted(async () => {
  try {
    const configData = await getHomeConfig()
    if (configData) {
      config.value = configData
    }
  } catch (error) {
    console.error('Failed to load data, using mock:', error)
    // Mock å…œåº•æ•°æ®
    config.value = {
      authorFeatures: {
        list: [
          {icon: 'ğŸ›¡ï¸', title: 'å®‰å¿ƒ', desc: 'ç‹¬å®¶çŸ¢é‡åˆ‡ç‰‡æŠ€æœ¯ä¸åŠ å¯†æµä¼ è¾“ã€‚ä½ åªç®¡æŒ¥æ´’æ‰åï¼Œæˆ‘ä»¬åšä½ æœ€åšå›ºçš„æŠ¤åŸæ²³ã€‚'},
          {icon: 'âš¡', title: 'çœå¿ƒ', desc: 'æ”¯æŒå…¨æœ¬ PDF ä¸€é”®å¯¼å…¥ï¼Œ1:1 åƒç´ çº§è¿˜åŸã€‚å‘Šåˆ«ç¹çæ’ç‰ˆï¼Œå‘å¸ƒåƒå‘¼å¸ä¸€æ ·è‡ªç„¶ã€‚'},
          {icon: 'ğŸ’°', title: 'åˆ©å¿ƒ', desc: 'æ‹’ç»â€œç”¨çˆ±å‘ç”µâ€ã€‚é«˜æ¯”ä¾‹åˆ†æˆä¸ç‹¬ç«‹å®šä»·æƒï¼Œè®©æ¯ä¸€è¡Œå­—ç¬¦çš„ä»·å€¼éƒ½å®å®åœ¨åœ¨ã€‚'}
        ]
      },
      readerFeatures: {
        list: [
          {icon: 'â˜•', title: 'èˆ’å¿ƒ', desc: 'èåˆçº¸ä¹¦çš„ä¼˜é›…ä¸æ•°å­—çš„ä¾¿æ·ã€‚PC å®½å±æ²‰æµ¸ï¼Œç§»åŠ¨ç«¯æµå¼é€‚é…ï¼Œä½ çš„æ•°å­—ä¹¦æˆ¿ã€‚'},
          {icon: 'ğŸ’¡', title: 'ä¼šå¿ƒ', desc: 'æœ¯è¯­å³ç‚¹å³æŸ¥ï¼Œéš¾ç‚¹è§†é¢‘å¼¹çª—ä¼´è¯»ã€‚æ‹’ç»æ­»è®°ç¡¬èƒŒï¼Œä»â€œçœ‹ä¸æ‡‚â€åˆ°â€œä¼šå¿ƒä¸€ç¬‘â€ã€‚'},
          {icon: 'ğŸ§˜', title: 'å®šå¿ƒ', desc: 'ä¸“å±ä»ªè¡¨ç›˜è®°å½•æ¯ä¸€ä¸ªè„šå°ã€‚åœ¨ç¢ç‰‡åŒ–çš„æ—¶ä»£ï¼Œå¸®ä½ æŠŠå¿ƒå®šä¸‹æ¥ï¼ŒæŠŠä¹¦è¯»è¿›å»ã€‚'}
        ]
      }
    }
  }
  resetInterval()
})

onUnmounted(() => {
  if (rotateInterval.value) {
    clearInterval(rotateInterval.value)
  }
})
</script>

<style scoped lang="scss">
/* ç§»é™¤ header ç›¸å…³çš„æ ·å¼ï¼Œå› ä¸ºå·²ç»ç§»åˆ° Layout äº† */
.portal-home {
  /* min-height ç”± Layout æ§åˆ¶ï¼Œè¿™é‡Œä¸éœ€è¦äº† */
}

.main-content {
  padding-top: 40px;
  padding-bottom: 40px;
}

.common-section {
  margin-bottom: 60px;
}

/* === é€šç”¨ç»„ä»¶ === */
.section-header {
  display: flex;
  align-items: flex-end; /* åº•éƒ¨å¯¹é½ */
  gap: 12px;
  margin-bottom: 20px;
}

.section-title {
  font-size: 22px;
  font-weight: 700;
  color: var(--text-primary);
  position: relative;
  padding-left: 12px;
  margin: 0;

  &::before {
    content: '';
    position: absolute;
    left: 0;
    top: 50%;
    transform: translateY(-50%);
    width: 4px;
    height: 18px;
    background-color: var(--primary);
    border-radius: 2px;
  }
}

.section-subtitle {
  font-size: 14px;
  color: #999;
  padding-bottom: 2px;
}

.section-card {
  background: #ffffff;
  border-radius: 16px;
  box-shadow: 0 8px 20px rgba(0, 0, 0, 0.03);
  border: 1px solid rgba(0, 0, 0, 0.02);
  transition: box-shadow 0.3s ease;

  &:hover {
    box-shadow: 0 12px 30px rgba(0, 0, 0, 0.06);
  }
}

/* === 1. Hero Section === */
.hero-card-layout {
  padding: 50px 60px;
  min-height: 400px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 60px;
}

.hero-text-side {
  flex: 1;
  display: flex;
  flex-direction: column;
  z-index: 2;
  min-width: 300px;
}

.hero-rotate-container {
  height: 28px;
  margin-bottom: 16px;
  font-size: 16px;
  color: #999;
}

.hero-slogan {
  font-size: 40px;
  font-weight: 800;
  color: #1a1a1a;
  line-height: 1.2;
  margin: 0 0 16px 0;
  letter-spacing: -1px;
}

.hero-desc {
  font-size: 16px;
  color: #555;
  line-height: 1.6;
  max-width: 520px;
  margin-bottom: 30px;
  text-align: left;
  text-indent: 2em;
}

.hero-actions {
  display: flex;
  gap: 16px;
}

.btn-primary {
  padding: 10px 40px; /* åŠ å®½ä¸€ç‚¹ï¼Œå› ä¸ºåªæœ‰ä¸€ä¸ªæŒ‰é’® */
  border-radius: 30px;
  font-size: 16px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s;
  background: #1a1a1a;
  color: white;
  border: none;

  &:hover {
    background: #000;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
  }
}

/* 3D Visual Book (ä¿æŒä¸å˜) */
.hero-visual-side {
  flex: 0 0 400px;
  height: 300px;
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  perspective: 1000px;
}

.mock-book-group {
  position: relative;
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  animation: gentleFloat 6s ease-in-out infinite;
}

.visual-book {
  width: 200px;
  height: 280px;
  background: linear-gradient(135deg, #2b2b2b 0%, #111 100%);
  border-radius: 4px 16px 16px 4px;
  position: relative;
  box-shadow: -20px 20px 40px rgba(0, 0, 0, 0.3);
  transform: rotateY(-20deg) rotateX(8deg);
  transform-style: preserve-3d;
  transition: transform 0.4s ease;

  &:hover {
    transform: rotateY(-10deg) rotateX(4deg) scale(1.02);
  }
}

.vb-spine {
  position: absolute;
  left: 0;
  top: 0;
  width: 20px;
  height: 100%;
  background: linear-gradient(to right, rgba(255, 255, 255, 0.1), transparent);
  z-index: 1;
  border-radius: 4px 0 0 4px;
}

.vb-face-content {
  position: relative;
  z-index: 2;
  width: 100%;
  height: 100%;
  padding: 30px;
  display: flex;
  flex-direction: column;
  align-items: center;
  box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.05);
  border-radius: 4px 16px 16px 4px;
}

.vb-cover-title {
  flex: 1;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
}

.vb-main-text {
  font-size: 28px;
  font-weight: 800;
  color: #fff;
  letter-spacing: 6px;
  font-family: "Songti SC", serif;
}

.vb-features {
  width: 100%;
  border-top: 1px solid rgba(255, 255, 255, 0.1);
  padding-top: 20px;
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.vb-feat-item {
  display: flex;
  align-items: center;
  gap: 10px;
  color: rgba(255, 255, 255, 0.7);
  font-size: 13px;
  font-weight: 500;
  background: rgba(255, 255, 255, 0.03);
  padding: 8px 14px;
  border-radius: 8px;
  transition: all 0.2s;

  &:hover {
    background: rgba(255, 255, 255, 0.08);
    color: #fff;
    transform: translateX(4px);
  }
}

/* === 2 & 3. Role Grids (åˆ›ä½œè€…/æ±‚ç´¢è€…) === */
/* ä½¿ç”¨ç»Ÿä¸€çš„ Grid å¸ƒå±€ */
.role-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 24px;
}

.wr-feature-card {
  background: white;
  border-radius: 16px;
  padding: 32px 24px;
  text-align: center;
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.02);
  border: 1px solid rgba(0, 0, 0, 0.02);
  transition: all 0.3s;

  &:hover {
    transform: translateY(-4px);
    box-shadow: 0 12px 30px rgba(0, 0, 0, 0.06);
  }
}

.fc-icon {
  font-size: 32px;
  margin: 0 auto 16px;
  background: #f8f8f8;
  width: 64px;
  height: 64px;
  line-height: 64px;
  border-radius: 50%;
}

.fc-title {
  font-size: 18px;
  font-weight: 700;
  margin: 0 0 10px;
  color: #333;
}

.fc-desc {
  font-size: 14px;
  color: #888;
  line-height: 1.6;
  text-align: left;
  text-indent: 2em;
}

/* === 4. Credo === */
.credo-layout {
  text-align: center;
  padding: 60px 40px;
  position: relative;
  overflow: hidden;

  &::before {
    content: "BELIEF";
    position: absolute;
    top: 20px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 90px;
    color: rgba(0, 0, 0, 0.03);
    font-weight: 900;
    pointer-events: none;
  }
}

.credo-diagram {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 16px;
  margin-bottom: 10px;
}

.cd-item {
  font-size: 14px;
  color: #bbb;
  text-transform: uppercase;
}

.cd-item.active {
  color: var(--primary);
  font-weight: 700;
}

.cd-line {
  width: 40px;
  height: 1px;
  background: #eee;
}

.credo-value {
  font-size: 18px;
  color: var(--primary);
  margin-bottom: 12px;
  letter-spacing: 4px;
}

.credo-text {
  font-size: 36px;
  font-weight: 400;
  color: #1a1a1a;
  margin: 0 0 24px 0;
  letter-spacing: 10px;
  font-family: "Songti SC", "SimSun", serif;
  white-space: nowrap;
  display: block;
}

.portal-footer {
  text-align: center;
  padding: 40px 0;
  color: #ccc;
  font-size: 12px;
  background: #f9f9f9;
  border-top: 1px solid #eee;
}

/* Animations */
.fade-slide-enter-active, .fade-slide-leave-active {
  transition: all 0.5s ease;
}

.fade-slide-enter-from {
  opacity: 0;
  transform: translateY(10px);
}

.fade-slide-leave-to {
  opacity: 0;
  transform: translateY(-10px);
}

.fade-enter-active, .fade-leave-active {
  transition: opacity 0.3s ease;
}

.fade-enter-from, .fade-leave-to {
  opacity: 0;
}

@keyframes gentleFloat {
  0%, 100% {
    transform: translateY(0);
  }
  50% {
    transform: translateY(-10px);
  }
}

@media (max-width: 1024px) {
  .hero-card-layout {
    flex-direction: column-reverse;
    padding: 40px 24px;
    text-align: center;
    gap: 30px;
  }
  .hero-text-side {
    width: 100%;
    align-items: center;
  }
  .hero-slogan {
    font-size: 28px;
  }
  .hero-desc {
    font-size: 14px;
  }
  .hero-visual-side {
    flex: unset;
    width: 100%;
    height: 280px;
    margin-bottom: 10px;
  }
  .role-grid {
    grid-template-columns: 1fr;
    gap: 16px;
  }
  .credo-text {
    font-size: 24px;
    letter-spacing: 4px;
    margin-bottom: 16px;
  }
  .credo-diagram {
    gap: 8px;

    .cd-line {
      width: 20px;
    }

    .cd-item {
      font-size: 12px;
    }
  }
}

@media (max-width: 375px) {
  .credo-text {
    font-size: 20px;
    letter-spacing: 2px;
  }
}
</style>